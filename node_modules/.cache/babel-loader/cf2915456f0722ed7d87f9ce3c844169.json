{"ast":null,"code":"import _regeneratorRuntime from \"/home/adarsh/Desktop/POC/Final/React/editor/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/adarsh/Desktop/POC/Final/React/editor/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/adarsh/Desktop/POC/Final/React/editor/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/adarsh/Desktop/POC/Final/React/editor/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/adarsh/Desktop/POC/Final/React/editor/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/adarsh/Desktop/POC/Final/React/editor/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/adarsh/Desktop/POC/Final/React/editor/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/adarsh/Desktop/POC/Final/React/editor/src/App.js\";\nimport React, { Component } from \"react\";\nimport \"./App.css\";\nimport $ from \"jquery\";\nimport \"jquery-ui/ui/widgets/draggable\";\nimport DragSelect from \"dragselect\";\nimport Button from \"./components/Button/Button\"; // --> OFF\n\n/* eslint no-undef: 0 */\n// eslint-disable-next-line \n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.state = {\n      btn: [{\n        value: \"Add Element\",\n        id: \"\"\n      }, {\n        value: \"Wrap\",\n        id: \"group\"\n      }, {\n        value: \"Unwrap\",\n        id: \"ungroup\"\n      }, {\n        value: \"unwrapPerm\",\n        id: \"ungroupIndivi\"\n      }, {\n        value: \"Delete\",\n        id: \"delete\"\n      }, {\n        value: \"Undo\",\n        id: \"undo\"\n      }, {\n        value: \"Redo\",\n        id: \"redo\"\n      }]\n    };\n\n    _this.updateButtons = function (history) {\n      $('#undo').attr('disabled', !history.canUndo());\n      $('#redo').attr('disabled', !history.canRedo());\n    };\n\n    _this.setEditorContents = function (contents) {\n      $('.main-container').val(contents);\n    };\n\n    _this.addElement = function () {\n      if ($(\".main-container\").children().length) {\n        var x = $(\".text:last\");\n        var top = parseFloat(x.css(\"top\").slice(0, -2));\n        x = x.attr(\"id\").slice(-1);\n        $(\".main-container\").append(\"<div class='text ele-select'>\" + Math.random().toFixed(2) + \"</div>\");\n        $(\".text:last\").attr(\"id\", \"text\" + ++x);\n        $(\".text:last\").css({\n          top: top + 27\n        });\n        $(\".text:last\").draggable({\n          cursor: \"move\"\n        });\n\n        _this.ds.addSelectables(document.getElementsByClassName(\"ele-select\"));\n      } else {\n        $(\".main-container\").append(\"<div class='text ele-select'>\" + Math.random().toFixed(2) + \"</div>\");\n        $(\".text\").attr(\"id\", \"text\" + 1);\n        $(\".text:last\").draggable({\n          cursor: \"move\"\n        });\n\n        _this.ds.addSelectables(document.getElementsByClassName(\"ele-select\"));\n      }\n    };\n\n    _this.setElemPosition = function (el, i, wrappedPostion) {\n      return new Promise(function (resolve, reject) {\n        var indivElePos = {};\n        indivElePos.top = el.top;\n        indivElePos.left = el.left;\n        indivElePos.diffTop = indivElePos.top < wrappedPostion.wrappedTop.top ? wrappedPostion.wrappedTop.top - indivElePos.top : indivElePos.top - wrappedPostion.wrappedTop.top;\n        indivElePos.diffLeft = indivElePos.left < wrappedPostion.wrappedLeft.left ? wrappedPostion.wrappedLeft.left - indivElePos.left : indivElePos.left - wrappedPostion.wrappedLeft.left;\n        $(\"#\" + el.id).css({\n          top: indivElePos.diffTop,\n          left: indivElePos.diffLeft\n        });\n        console.log(\"indivElePos\", indivElePos);\n        resolve(indivElePos);\n      });\n    };\n\n    _this.check = function (idArr) {\n      if (idArr[0].length > 1 && idArr !== \"permGroup\") {\n        var valTemp = idArr[0].map(function (value) {\n          return \"#\" + $(value).attr(\"id\");\n        });\n        var valString = valTemp.toString();\n        $(valString).wrapAll('<div class=\"wrapped ele-select\"></div>');\n        valTemp.forEach(function (element) {\n          $(element).draggable(\"disable\");\n        });\n        $(\".wrapped\").draggable({\n          cursor: \"move\"\n        });\n        var ch = $(\".wrapped\").children();\n        var childArray = [];\n        ch.each(function (i, el) {\n          childArray.push(el);\n        });\n        var wrappedPostion = {\n          totalHeight: 0,\n          totalWidth: 0,\n          totalDiffLeft: 0,\n          totalDiffTop: 0\n        };\n        var postionArray = childArray.map(function (element) {\n          var obj = {};\n          obj.id = $(element).attr(\"id\");\n          obj.top = parseFloat($(element).css(\"top\").slice(0, -2));\n          obj.left = parseFloat($(element).css(\"left\").slice(0, -2));\n          obj.height = $(element).outerHeight();\n          obj.width = $(element).outerWidth();\n          obj.right = obj.left + obj.width;\n          obj.bottom = obj.top + obj.height;\n\n          if (wrappedPostion.totalWidth < $(element).outerWidth()) {\n            wrappedPostion.totalWidth = $(element).outerWidth();\n          }\n\n          return obj;\n        });\n        var wrappedDetails = {};\n        postionArray.sort(function (a, b) {\n          return b.top < a.top ? 1 : -1;\n        });\n        console.log(\"postionArray after sorting\", postionArray);\n        wrappedPostion.wrappedTop = postionArray.hasMin(\"top\");\n        wrappedPostion.wrappedLeft = postionArray.hasMin(\"left\");\n        wrappedPostion.wrappedRight = postionArray.hasMax(\"right\");\n        wrappedPostion.wrappedBottom = postionArray.hasMax(\"bottom\");\n        console.log(wrappedPostion);\n        $(\".wrapped\").css({\n          top: wrappedPostion.wrappedTop.top,\n          left: wrappedPostion.wrappedLeft.left,\n          width: wrappedPostion.wrappedRight.right - wrappedPostion.wrappedLeft.left,\n          height: wrappedPostion.wrappedBottom.bottom - wrappedPostion.wrappedTop.top\n        });\n        postionArray.map(\n        /*#__PURE__*/\n        function () {\n          var _ref = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee(el, i) {\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return _this.setElemPosition(el, i, wrappedPostion).then(function (val) {\n                      postionArray[i].diffTop = val.diffTop;\n                      postionArray[i].diffLeft = val.diffLeft;\n\n                      if (wrappedPostion.totalDiffLeft < val.diffLeft) {\n                        wrappedPostion.totalDiffLeft = val.diffLeft;\n                      }\n\n                      console.log(\"setElemPosition postionArray\", postionArray);\n                      console.log(\"setElemPosition wrappedPostion\", wrappedPostion);\n                    });\n\n                  case 2:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee);\n          }));\n\n          return function (_x, _x2) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      } else {\n        // console.log(idArr)\n        if (idArr === \"permGroup\") {\n          var count = 0;\n          Array.prototype.slice.call(document.querySelectorAll(\".wrapped\")).forEach(function (wrapped) {\n            Array.prototype.slice.call($(\".wrapped\").children()).forEach(function (wrappedChild) {\n              if ($(wrappedChild).attr(\"id\").indexOf(\"perm\") > -1) {\n                count++;\n              }\n            });\n          });\n\n          if (count === 0) {\n            $(\".wrapped\").toggleClass(\"wrapped perm-wrapped\");\n            var cnt = $(\".perm-wrapped\");\n            cnt.each(function (i, el) {\n              $(el).attr(\"id\", \"perm-select\" + i);\n            });\n            cnt.children().each(function (i, el) {\n              $(el).removeClass(\"ele-select\");\n            });\n            Array.prototype.slice.call(document.querySelectorAll(\".perm-wrapped\")).forEach(function (wrapped) {\n              _this.ds.addSelectables(wrapped);\n\n              _this.ds.removeSelectables(wrapped.children, true);\n            });\n          } else {\n            alert(\"Kindly ungroup and then group\");\n          }\n        }\n      }\n    };\n\n    _this.unwrapPer = function () {\n      console.log(permID);\n      var val = $(permID).attr(\"id\");\n      permID = \"\";\n      var cnt = $(\"#\" + val);\n      cnt.children().each(function (i, el) {\n        var parent = $(el).parent().position();\n        var pTop = parent.top;\n        var pLeft = parent.left;\n        console.log($(el).parent(), parent);\n        console.log(pTop, pLeft);\n        $(el).css({\n          top: parseFloat($(el).css(\"top\").slice(0, -2)) + pTop,\n          left: parseFloat($(el).css(\"left\").slice(0, -2)) + pLeft\n        });\n        $(el).draggable(\"enable\");\n        $(el).addClass(\"ele-select\");\n\n        _this.ds.addSelectables(el);\n      });\n      cnt.children().unwrap();\n    };\n\n    _this.unwrapAll = function (val, event) {\n      var wrappedTop, wrappedLeft;\n\n      if (val === \"perm-ungroup\") {\n        var cnt = $(\".perm-wrapped\");\n        $(\"#ungroupIndivi\").css({\n          opacity: 1\n        });\n      } else {\n        var cnt = $(\".wrapped\");\n        wrappedTop = parseFloat($(\".wrapped\").css(\"top\").slice(0, -2));\n        wrappedLeft = parseFloat($(\".wrapped\").css(\"left\").slice(0, -2)); // console.log(wrappedTop, wrappedLeft)\n      }\n\n      cnt.children().each(function (i, el) {\n        var parent = $(el).parent().position();\n        var pTop = parent.top;\n        var pLeft = parent.left;\n        $(el).css({\n          top: parseFloat($(el).css(\"top\").slice(0, -2)) + pTop,\n          left: parseFloat($(el).css(\"left\").slice(0, -2)) + pLeft\n        });\n        $(el).draggable(\"enable\");\n        $(el).addClass(\"ele-select\");\n\n        _this.ds.addSelectables(el);\n      });\n      cnt.children().unwrap();\n    };\n\n    _this.deleteElme = function (e) {\n      console.log(e);\n\n      if (e.keyCode === 127 || e.type === 'click') {\n        if ($(_this.deleteElm).parent().attr('class') !== 'main-container') {\n          $(_this.deleteElm).parent().remove();\n        } else {\n          $(_this.deleteElm).remove();\n        }\n      }\n    };\n\n    _this.clickHandler = function (val, event) {\n      console.log(val);\n\n      if (val.value === \"Add Element\") {\n        _this.addElement();\n      }\n\n      if (val.value === \"Wrap\") {\n        _this.check(\"permGroup\");\n      }\n\n      if (val.value === \"Unwrap\") {\n        _this.unwrapAll(\"perm-ungroup\");\n      }\n\n      if (val.value === \"Delete\") {\n        _this.deleteElme(event);\n      }\n    };\n\n    var ds;\n    _this.ds = ds;\n\n    var _permID, deleteElm, _history;\n\n    _this.history = _history;\n    _this.deleteElm = deleteElm;\n\n    Array.prototype.hasMin = function (attrib) {\n      return this.reduce(function (prev, curr) {\n        return prev[attrib] < curr[attrib] ? prev : curr;\n      });\n    };\n\n    Array.prototype.hasMax = function (attrib) {\n      return this.reduce(function (prev, curr) {\n        return prev[attrib] > curr[attrib] ? prev : curr;\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.history = new SimpleUndo({\n        maxLength: 200,\n        provider: function provider(done) {\n          done($('#canvas').val());\n        },\n        onUpdate: function onUpdate() {\n          //onUpdate is called in constructor, making history undefined\n          if (!_this2.history) return;\n          updateButtons(_this2.history);\n        }\n      });\n      $('#undo').click(function () {\n        this.history.undo(setEditorContents);\n      });\n      $('#redo').click(function () {\n        this.history.redo(setEditorContents);\n      });\n      $('#editor').keypress(function () {\n        this.history.save();\n      });\n      updateButtons(this.history);\n      var idArray = [];\n      var permIdarray = [];\n      this.ds = new DragSelect({\n        selectables: document.getElementsByClassName(\"ele-select\"),\n        area: document.getElementById(\"canvas\"),\n        onElementSelect: function onElementSelect(element) {\n          idArray.push(_this2.ds.getSelection());\n          console.log(idArray);\n          permIdarray = idArray.map(function (element) {\n            if ($(element).attr(\"id\").indexOf(\"perm\") > -1) {\n              return;\n            }\n          });\n        }\n      });\n      $(\".text\").draggable({\n        cursor: \"move\"\n      });\n      $(\"#canvas\").on(\"mousedown\", \".main-container\", function (e) {\n        $(\"#ungroupIndivi\").css({\n          opacity: 0\n        });\n        $(\"#delete\").css({\n          opacity: 0\n        });\n\n        if ($(e.target).attr(\"class\").indexOf(\"main-container\") > -1) {\n          if ($(\".wrapped\").length > 0) {\n            _this2.unwrapAll();\n          }\n\n          _this2.ds.start();\n        } else {\n          _this2.deleteElm = e.target;\n          $(\"#delete\").css({\n            opacity: 1\n          });\n          idArray = [];\n\n          _this2.ds.stop();\n\n          _this2.ds.break();\n        }\n      });\n      $(\"#canvas\").on(\"mouseup\", function (e) {\n        if (idArray.length > 1) {\n          _this2.check(idArray);\n        }\n\n        _this2.ds.stop();\n\n        _this2.ds.start();\n      });\n      $(\"body\").on(\"keypress\", function (e) {\n        if (_this2.deleteElm) {\n          _this2.deleteElme(e);\n        }\n\n        ;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var button = this.state.btn.map(function (element, i) {\n        return React.createElement(Button, {\n          value: element,\n          clicked: function clicked(event) {\n            return _this3.clickHandler(element, event);\n          },\n          key: i + element,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 414\n          },\n          __self: this\n        });\n      });\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 422\n        },\n        __self: this\n      }, button, React.createElement(\"div\", {\n        id: \"canvas\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 424\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"main-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 425\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"text ele-select\",\n        id: \"text1\",\n        draggable: \"true\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 426\n        },\n        __self: this\n      }, \"Some text\"), React.createElement(\"div\", {\n        className: \"text ele-select\",\n        id: \"text2\",\n        draggable: \"true\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 429\n        },\n        __self: this\n      }, \"Another text\"))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/home/adarsh/Desktop/POC/Final/React/editor/src/App.js"],"names":["React","Component","$","DragSelect","Button","App","props","state","btn","value","id","updateButtons","history","attr","canUndo","canRedo","setEditorContents","contents","val","addElement","children","length","x","top","parseFloat","css","slice","append","Math","random","toFixed","draggable","cursor","ds","addSelectables","document","getElementsByClassName","setElemPosition","el","i","wrappedPostion","Promise","resolve","reject","indivElePos","left","diffTop","wrappedTop","diffLeft","wrappedLeft","console","log","check","idArr","valTemp","map","valString","toString","wrapAll","forEach","element","ch","childArray","each","push","totalHeight","totalWidth","totalDiffLeft","totalDiffTop","postionArray","obj","height","outerHeight","width","outerWidth","right","bottom","wrappedDetails","sort","a","b","hasMin","wrappedRight","hasMax","wrappedBottom","then","count","Array","prototype","call","querySelectorAll","wrapped","wrappedChild","indexOf","toggleClass","cnt","removeClass","removeSelectables","alert","unwrapPer","permID","parent","position","pTop","pLeft","addClass","unwrap","unwrapAll","event","opacity","deleteElme","e","keyCode","type","deleteElm","remove","clickHandler","attrib","reduce","prev","curr","SimpleUndo","maxLength","provider","done","onUpdate","click","undo","redo","keypress","save","idArray","permIdarray","selectables","area","getElementById","onElementSelect","getSelection","on","target","start","stop","break","button"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,WAAP;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAO,gCAAP;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,MAAP,MAAmB,4BAAnB,C,CAAiD;;AAEjD;AACA;;IACMC,G;;;;;AAYJ,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,6EAAMA,KAAN;AADiB,UAXnBC,KAWmB,GAXX;AACNC,MAAAA,GAAG,EAAE,CACH;AAAEC,QAAAA,KAAK,EAAE,aAAT;AAAwBC,QAAAA,EAAE,EAAE;AAA5B,OADG,EAEH;AAAED,QAAAA,KAAK,EAAE,MAAT;AAAiBC,QAAAA,EAAE,EAAE;AAArB,OAFG,EAGH;AAAED,QAAAA,KAAK,EAAE,QAAT;AAAmBC,QAAAA,EAAE,EAAE;AAAvB,OAHG,EAIH;AAAED,QAAAA,KAAK,EAAE,YAAT;AAAuBC,QAAAA,EAAE,EAAE;AAA3B,OAJG,EAKH;AAAED,QAAAA,KAAK,EAAE,QAAT;AAAmBC,QAAAA,EAAE,EAAE;AAAvB,OALG,EAMH;AAAED,QAAAA,KAAK,EAAE,MAAT;AAAiBC,QAAAA,EAAE,EAAE;AAArB,OANG,EAOH;AAAED,QAAAA,KAAK,EAAE,MAAT;AAAiBC,QAAAA,EAAE,EAAE;AAArB,OAPG;AADC,KAWW;;AAAA,UAoBpBC,aApBoB,GAoBJ,UAACC,OAAD,EAAc;AAC9BV,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAWW,IAAX,CAAgB,UAAhB,EAA2B,CAACD,OAAO,CAACE,OAAR,EAA5B;AACAZ,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAWW,IAAX,CAAgB,UAAhB,EAA2B,CAACD,OAAO,CAACG,OAAR,EAA5B;AACA,KAvBoB;;AAAA,UAyBrBC,iBAzBqB,GAyBD,UAACC,QAAD,EAAc;AACjCf,MAAAA,CAAC,CAAC,iBAAD,CAAD,CAAqBgB,GAArB,CAAyBD,QAAzB;AACA,KA3BoB;;AAAA,UAmHnBE,UAnHmB,GAmHN,YAAM;AACjB,UAAIjB,CAAC,CAAC,iBAAD,CAAD,CAAqBkB,QAArB,GAAgCC,MAApC,EAA4C;AAC1C,YAAIC,CAAC,GAAGpB,CAAC,CAAC,YAAD,CAAT;AACA,YAAIqB,GAAG,GAAGC,UAAU,CAACF,CAAC,CAACG,GAAF,CAAM,KAAN,EAAaC,KAAb,CAAmB,CAAnB,EAAsB,CAAC,CAAvB,CAAD,CAApB;AACAJ,QAAAA,CAAC,GAAGA,CAAC,CAACT,IAAF,CAAO,IAAP,EAAaa,KAAb,CAAmB,CAAC,CAApB,CAAJ;AACAxB,QAAAA,CAAC,CAAC,iBAAD,CAAD,CAAqByB,MAArB,CACE,kCAAkCC,IAAI,CAACC,MAAL,GAAcC,OAAd,CAAsB,CAAtB,CAAlC,GAA6D,QAD/D;AAGA5B,QAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBW,IAAhB,CAAqB,IAArB,EAA2B,SAAS,EAAES,CAAtC;AACApB,QAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBuB,GAAhB,CAAoB;AAClBF,UAAAA,GAAG,EAAEA,GAAG,GAAG;AADO,SAApB;AAGArB,QAAAA,CAAC,CAAC,YAAD,CAAD,CAAgB6B,SAAhB,CAA0B;AACxBC,UAAAA,MAAM,EAAE;AADgB,SAA1B;;AAGA,cAAKC,EAAL,CAAQC,cAAR,CAAuBC,QAAQ,CAACC,sBAAT,CAAgC,YAAhC,CAAvB;AACD,OAfD,MAeO;AACLlC,QAAAA,CAAC,CAAC,iBAAD,CAAD,CAAqByB,MAArB,CACE,kCAAkCC,IAAI,CAACC,MAAL,GAAcC,OAAd,CAAsB,CAAtB,CAAlC,GAA6D,QAD/D;AAGA5B,QAAAA,CAAC,CAAC,OAAD,CAAD,CAAWW,IAAX,CAAgB,IAAhB,EAAsB,SAAS,CAA/B;AACAX,QAAAA,CAAC,CAAC,YAAD,CAAD,CAAgB6B,SAAhB,CAA0B;AACxBC,UAAAA,MAAM,EAAE;AADgB,SAA1B;;AAGA,cAAKC,EAAL,CAAQC,cAAR,CAAuBC,QAAQ,CAACC,sBAAT,CAAgC,YAAhC,CAAvB;AACD;AACF,KA7IkB;;AAAA,UA+InBC,eA/ImB,GA+ID,UAACC,EAAD,EAAKC,CAAL,EAAQC,cAAR,EAA2B;AAC3C,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,YAAIC,WAAW,GAAG,EAAlB;AACAA,QAAAA,WAAW,CAACrB,GAAZ,GAAkBe,EAAE,CAACf,GAArB;AACAqB,QAAAA,WAAW,CAACC,IAAZ,GAAmBP,EAAE,CAACO,IAAtB;AACAD,QAAAA,WAAW,CAACE,OAAZ,GACEF,WAAW,CAACrB,GAAZ,GAAkBiB,cAAc,CAACO,UAAf,CAA0BxB,GAA5C,GACIiB,cAAc,CAACO,UAAf,CAA0BxB,GAA1B,GAAgCqB,WAAW,CAACrB,GADhD,GAEIqB,WAAW,CAACrB,GAAZ,GAAkBiB,cAAc,CAACO,UAAf,CAA0BxB,GAHlD;AAIAqB,QAAAA,WAAW,CAACI,QAAZ,GACEJ,WAAW,CAACC,IAAZ,GAAmBL,cAAc,CAACS,WAAf,CAA2BJ,IAA9C,GACIL,cAAc,CAACS,WAAf,CAA2BJ,IAA3B,GAAkCD,WAAW,CAACC,IADlD,GAEID,WAAW,CAACC,IAAZ,GAAmBL,cAAc,CAACS,WAAf,CAA2BJ,IAHpD;AAIA3C,QAAAA,CAAC,CAAC,MAAMoC,EAAE,CAAC5B,EAAV,CAAD,CAAee,GAAf,CAAmB;AACjBF,UAAAA,GAAG,EAAEqB,WAAW,CAACE,OADA;AAEjBD,UAAAA,IAAI,EAAED,WAAW,CAACI;AAFD,SAAnB;AAIAE,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BP,WAA3B;AACAF,QAAAA,OAAO,CAACE,WAAD,CAAP;AACD,OAlBM,CAAP;AAmBD,KAnKkB;;AAAA,UAqKnBQ,KArKmB,GAqKX,UAAAC,KAAK,EAAI;AACf,UAAIA,KAAK,CAAC,CAAD,CAAL,CAAShC,MAAT,GAAkB,CAAlB,IAAuBgC,KAAK,KAAK,WAArC,EAAkD;AAChD,YAAIC,OAAO,GAAGD,KAAK,CAAC,CAAD,CAAL,CAASE,GAAT,CAAa,UAAA9C,KAAK,EAAI;AAClC,iBAAO,MAAMP,CAAC,CAACO,KAAD,CAAD,CAASI,IAAT,CAAc,IAAd,CAAb;AACD,SAFa,CAAd;AAGA,YAAI2C,SAAS,GAAGF,OAAO,CAACG,QAAR,EAAhB;AACAvD,QAAAA,CAAC,CAACsD,SAAD,CAAD,CAAaE,OAAb,CAAqB,wCAArB;AACAJ,QAAAA,OAAO,CAACK,OAAR,CAAgB,UAAAC,OAAO,EAAI;AACzB1D,UAAAA,CAAC,CAAC0D,OAAD,CAAD,CAAW7B,SAAX,CAAqB,SAArB;AACD,SAFD;AAGA7B,QAAAA,CAAC,CAAC,UAAD,CAAD,CAAc6B,SAAd,CAAwB;AACtBC,UAAAA,MAAM,EAAE;AADc,SAAxB;AAGA,YAAI6B,EAAE,GAAG3D,CAAC,CAAC,UAAD,CAAD,CAAckB,QAAd,EAAT;AACA,YAAI0C,UAAU,GAAG,EAAjB;AACAD,QAAAA,EAAE,CAACE,IAAH,CAAQ,UAACxB,CAAD,EAAID,EAAJ,EAAW;AACjBwB,UAAAA,UAAU,CAACE,IAAX,CAAgB1B,EAAhB;AACD,SAFD;AAGA,YAAIE,cAAc,GAAG;AACnByB,UAAAA,WAAW,EAAE,CADM;AAEnBC,UAAAA,UAAU,EAAE,CAFO;AAGnBC,UAAAA,aAAa,EAAE,CAHI;AAInBC,UAAAA,YAAY,EAAE;AAJK,SAArB;AAMA,YAAIC,YAAY,GAAGP,UAAU,CAACP,GAAX,CAAe,UAAAK,OAAO,EAAI;AAC3C,cAAIU,GAAG,GAAG,EAAV;AACAA,UAAAA,GAAG,CAAC5D,EAAJ,GAASR,CAAC,CAAC0D,OAAD,CAAD,CAAW/C,IAAX,CAAgB,IAAhB,CAAT;AACAyD,UAAAA,GAAG,CAAC/C,GAAJ,GAAUC,UAAU,CAClBtB,CAAC,CAAC0D,OAAD,CAAD,CACGnC,GADH,CACO,KADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADkB,CAApB;AAKA4C,UAAAA,GAAG,CAACzB,IAAJ,GAAWrB,UAAU,CACnBtB,CAAC,CAAC0D,OAAD,CAAD,CACGnC,GADH,CACO,MADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADmB,CAArB;AAKA4C,UAAAA,GAAG,CAACC,MAAJ,GAAarE,CAAC,CAAC0D,OAAD,CAAD,CAAWY,WAAX,EAAb;AACAF,UAAAA,GAAG,CAACG,KAAJ,GAAYvE,CAAC,CAAC0D,OAAD,CAAD,CAAWc,UAAX,EAAZ;AACAJ,UAAAA,GAAG,CAACK,KAAJ,GAAYL,GAAG,CAACzB,IAAJ,GAAWyB,GAAG,CAACG,KAA3B;AACAH,UAAAA,GAAG,CAACM,MAAJ,GAAaN,GAAG,CAAC/C,GAAJ,GAAU+C,GAAG,CAACC,MAA3B;;AACA,cAAI/B,cAAc,CAAC0B,UAAf,GAA4BhE,CAAC,CAAC0D,OAAD,CAAD,CAAWc,UAAX,EAAhC,EAAyD;AACvDlC,YAAAA,cAAc,CAAC0B,UAAf,GAA4BhE,CAAC,CAAC0D,OAAD,CAAD,CAAWc,UAAX,EAA5B;AACD;;AACD,iBAAOJ,GAAP;AACD,SArBkB,CAAnB;AAsBA,YAAIO,cAAc,GAAG,EAArB;AACAR,QAAAA,YAAY,CAACS,IAAb,CAAkB,UAACC,CAAD,EAAIC,CAAJ;AAAA,iBAAWA,CAAC,CAACzD,GAAF,GAAQwD,CAAC,CAACxD,GAAV,GAAgB,CAAhB,GAAoB,CAAC,CAAhC;AAAA,SAAlB;AACA2B,QAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ,EAA0CkB,YAA1C;AACA7B,QAAAA,cAAc,CAACO,UAAf,GAA4BsB,YAAY,CAACY,MAAb,CAAoB,KAApB,CAA5B;AACAzC,QAAAA,cAAc,CAACS,WAAf,GAA6BoB,YAAY,CAACY,MAAb,CAAoB,MAApB,CAA7B;AACAzC,QAAAA,cAAc,CAAC0C,YAAf,GAA8Bb,YAAY,CAACc,MAAb,CAAoB,OAApB,CAA9B;AACA3C,QAAAA,cAAc,CAAC4C,aAAf,GAA+Bf,YAAY,CAACc,MAAb,CAAoB,QAApB,CAA/B;AACAjC,QAAAA,OAAO,CAACC,GAAR,CAAYX,cAAZ;AACAtC,QAAAA,CAAC,CAAC,UAAD,CAAD,CAAcuB,GAAd,CAAkB;AAChBF,UAAAA,GAAG,EAAEiB,cAAc,CAACO,UAAf,CAA0BxB,GADf;AAEhBsB,UAAAA,IAAI,EAAEL,cAAc,CAACS,WAAf,CAA2BJ,IAFjB;AAGhB4B,UAAAA,KAAK,EACHjC,cAAc,CAAC0C,YAAf,CAA4BP,KAA5B,GAAoCnC,cAAc,CAACS,WAAf,CAA2BJ,IAJjD;AAKhB0B,UAAAA,MAAM,EACJ/B,cAAc,CAAC4C,aAAf,CAA6BR,MAA7B,GAAsCpC,cAAc,CAACO,UAAf,CAA0BxB;AANlD,SAAlB;AAQA8C,QAAAA,YAAY,CAACd,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA,mCAAiB,iBAAOjB,EAAP,EAAWC,CAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BACT,MAAKF,eAAL,CAAqBC,EAArB,EAAyBC,CAAzB,EAA4BC,cAA5B,EAA4C6C,IAA5C,CAAiD,UAAAnE,GAAG,EAAI;AAC5DmD,sBAAAA,YAAY,CAAC9B,CAAD,CAAZ,CAAgBO,OAAhB,GAA0B5B,GAAG,CAAC4B,OAA9B;AACAuB,sBAAAA,YAAY,CAAC9B,CAAD,CAAZ,CAAgBS,QAAhB,GAA2B9B,GAAG,CAAC8B,QAA/B;;AACA,0BAAIR,cAAc,CAAC2B,aAAf,GAA+BjD,GAAG,CAAC8B,QAAvC,EAAiD;AAC/CR,wBAAAA,cAAc,CAAC2B,aAAf,GAA+BjD,GAAG,CAAC8B,QAAnC;AACD;;AACDE,sBAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ,EAA4CkB,YAA5C;AACAnB,sBAAAA,OAAO,CAACC,GAAR,CAAY,gCAAZ,EAA8CX,cAA9C;AACD,qBARK,CADS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAjB;;AAAA;AAAA;AAAA;AAAA;AAWD,OAxED,MAwEO;AACL;AACA,YAAIa,KAAK,KAAK,WAAd,EAA2B;AACzB,cAAIiC,KAAK,GAAG,CAAZ;AACAC,UAAAA,KAAK,CAACC,SAAN,CAAgB9D,KAAhB,CACG+D,IADH,CACQtD,QAAQ,CAACuD,gBAAT,CAA0B,UAA1B,CADR,EAEG/B,OAFH,CAEW,UAAAgC,OAAO,EAAI;AAClBJ,YAAAA,KAAK,CAACC,SAAN,CAAgB9D,KAAhB,CACG+D,IADH,CACQvF,CAAC,CAAC,UAAD,CAAD,CAAckB,QAAd,EADR,EAEGuC,OAFH,CAEW,UAAAiC,YAAY,EAAI;AACvB,kBACE1F,CAAC,CAAC0F,YAAD,CAAD,CACG/E,IADH,CACQ,IADR,EAEGgF,OAFH,CAEW,MAFX,IAEqB,CAAC,CAHxB,EAIE;AACAP,gBAAAA,KAAK;AACN;AACF,aAVH;AAWD,WAdH;;AAeA,cAAIA,KAAK,KAAK,CAAd,EAAiB;AACfpF,YAAAA,CAAC,CAAC,UAAD,CAAD,CAAc4F,WAAd,CAA0B,sBAA1B;AACA,gBAAIC,GAAG,GAAG7F,CAAC,CAAC,eAAD,CAAX;AACA6F,YAAAA,GAAG,CAAChC,IAAJ,CAAS,UAACxB,CAAD,EAAID,EAAJ,EAAW;AAClBpC,cAAAA,CAAC,CAACoC,EAAD,CAAD,CAAMzB,IAAN,CAAW,IAAX,EAAiB,gBAAgB0B,CAAjC;AACD,aAFD;AAGAwD,YAAAA,GAAG,CAAC3E,QAAJ,GAAe2C,IAAf,CAAoB,UAACxB,CAAD,EAAID,EAAJ,EAAW;AAC7BpC,cAAAA,CAAC,CAACoC,EAAD,CAAD,CAAM0D,WAAN,CAAkB,YAAlB;AACD,aAFD;AAGAT,YAAAA,KAAK,CAACC,SAAN,CAAgB9D,KAAhB,CACG+D,IADH,CACQtD,QAAQ,CAACuD,gBAAT,CAA0B,eAA1B,CADR,EAEG/B,OAFH,CAEW,UAAAgC,OAAO,EAAI;AAClB,oBAAK1D,EAAL,CAAQC,cAAR,CAAuByD,OAAvB;;AACA,oBAAK1D,EAAL,CAAQgE,iBAAR,CAA0BN,OAAO,CAACvE,QAAlC,EAA4C,IAA5C;AACD,aALH;AAMD,WAfD,MAeO;AACL8E,YAAAA,KAAK,CAAC,+BAAD,CAAL;AACD;AACF;AACF;AACF,KArRkB;;AAAA,UAuRnBC,SAvRmB,GAuRP,YAAM;AAChBjD,MAAAA,OAAO,CAACC,GAAR,CAAYiD,MAAZ;AACA,UAAIlF,GAAG,GAAGhB,CAAC,CAACkG,MAAD,CAAD,CAAUvF,IAAV,CAAe,IAAf,CAAV;AACAuF,MAAAA,MAAM,GAAG,EAAT;AACA,UAAIL,GAAG,GAAG7F,CAAC,CAAC,MAAMgB,GAAP,CAAX;AAEA6E,MAAAA,GAAG,CAAC3E,QAAJ,GAAe2C,IAAf,CAAoB,UAACxB,CAAD,EAAID,EAAJ,EAAW;AAC7B,YAAI+D,MAAM,GAAGnG,CAAC,CAACoC,EAAD,CAAD,CACV+D,MADU,GAEVC,QAFU,EAAb;AAGA,YAAIC,IAAI,GAAGF,MAAM,CAAC9E,GAAlB;AACA,YAAIiF,KAAK,GAAGH,MAAM,CAACxD,IAAnB;AACAK,QAAAA,OAAO,CAACC,GAAR,CAAYjD,CAAC,CAACoC,EAAD,CAAD,CAAM+D,MAAN,EAAZ,EAA4BA,MAA5B;AACAnD,QAAAA,OAAO,CAACC,GAAR,CAAYoD,IAAZ,EAAkBC,KAAlB;AACAtG,QAAAA,CAAC,CAACoC,EAAD,CAAD,CAAMb,GAAN,CAAU;AACRF,UAAAA,GAAG,EACDC,UAAU,CACRtB,CAAC,CAACoC,EAAD,CAAD,CACGb,GADH,CACO,KADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADQ,CAAV,GAII6E,IANE;AAOR1D,UAAAA,IAAI,EACFrB,UAAU,CACRtB,CAAC,CAACoC,EAAD,CAAD,CACGb,GADH,CACO,MADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADQ,CAAV,GAII8E;AAZE,SAAV;AAcAtG,QAAAA,CAAC,CAACoC,EAAD,CAAD,CAAMP,SAAN,CAAgB,QAAhB;AACA7B,QAAAA,CAAC,CAACoC,EAAD,CAAD,CAAMmE,QAAN,CAAe,YAAf;;AACA,cAAKxE,EAAL,CAAQC,cAAR,CAAuBI,EAAvB;AACD,OAzBD;AA0BAyD,MAAAA,GAAG,CAAC3E,QAAJ,GAAesF,MAAf;AACD,KAxTkB;;AAAA,UA2TnBC,SA3TmB,GA2TP,UAACzF,GAAD,EAAM0F,KAAN,EAAgB;AAC1B,UAAI7D,UAAJ,EAAgBE,WAAhB;;AACA,UAAI/B,GAAG,KAAK,cAAZ,EAA4B;AAC1B,YAAI6E,GAAG,GAAG7F,CAAC,CAAC,eAAD,CAAX;AACAA,QAAAA,CAAC,CAAC,gBAAD,CAAD,CAAoBuB,GAApB,CAAwB;AACtBoF,UAAAA,OAAO,EAAE;AADa,SAAxB;AAGD,OALD,MAKO;AACL,YAAId,GAAG,GAAG7F,CAAC,CAAC,UAAD,CAAX;AACA6C,QAAAA,UAAU,GAAGvB,UAAU,CACrBtB,CAAC,CAAC,UAAD,CAAD,CACGuB,GADH,CACO,KADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADqB,CAAvB;AAKAuB,QAAAA,WAAW,GAAGzB,UAAU,CACtBtB,CAAC,CAAC,UAAD,CAAD,CACGuB,GADH,CACO,MADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADsB,CAAxB,CAPK,CAYL;AACD;;AAEDqE,MAAAA,GAAG,CAAC3E,QAAJ,GAAe2C,IAAf,CAAoB,UAACxB,CAAD,EAAID,EAAJ,EAAW;AAC7B,YAAI+D,MAAM,GAAGnG,CAAC,CAACoC,EAAD,CAAD,CACV+D,MADU,GAEVC,QAFU,EAAb;AAGA,YAAIC,IAAI,GAAGF,MAAM,CAAC9E,GAAlB;AACA,YAAIiF,KAAK,GAAGH,MAAM,CAACxD,IAAnB;AACA3C,QAAAA,CAAC,CAACoC,EAAD,CAAD,CAAMb,GAAN,CAAU;AACRF,UAAAA,GAAG,EACDC,UAAU,CACRtB,CAAC,CAACoC,EAAD,CAAD,CACGb,GADH,CACO,KADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADQ,CAAV,GAII6E,IANE;AAOR1D,UAAAA,IAAI,EACFrB,UAAU,CACRtB,CAAC,CAACoC,EAAD,CAAD,CACGb,GADH,CACO,MADP,EAEGC,KAFH,CAES,CAFT,EAEY,CAAC,CAFb,CADQ,CAAV,GAII8E;AAZE,SAAV;AAcAtG,QAAAA,CAAC,CAACoC,EAAD,CAAD,CAAMP,SAAN,CAAgB,QAAhB;AACA7B,QAAAA,CAAC,CAACoC,EAAD,CAAD,CAAMmE,QAAN,CAAe,YAAf;;AACA,cAAKxE,EAAL,CAAQC,cAAR,CAAuBI,EAAvB;AACD,OAvBD;AAwBAyD,MAAAA,GAAG,CAAC3E,QAAJ,GAAesF,MAAf;AACD,KA1WkB;;AAAA,UA2WnBI,UA3WmB,GA2WN,UAAAC,CAAC,EAAI;AAChB7D,MAAAA,OAAO,CAACC,GAAR,CAAY4D,CAAZ;;AACA,UAAIA,CAAC,CAACC,OAAF,KAAc,GAAd,IAAqBD,CAAC,CAACE,IAAF,KAAW,OAApC,EAA6C;AAC3C,YAAI/G,CAAC,CAAC,MAAKgH,SAAN,CAAD,CAAkBb,MAAlB,GAA2BxF,IAA3B,CAAgC,OAAhC,MAA6C,gBAAjD,EAAmE;AAC/DX,UAAAA,CAAC,CAAC,MAAKgH,SAAN,CAAD,CAAkBb,MAAlB,GAA2Bc,MAA3B;AACH,SAFD,MAGK;AACDjH,UAAAA,CAAC,CAAC,MAAKgH,SAAN,CAAD,CAAkBC,MAAlB;AACH;AACJ;AACA,KArXkB;;AAAA,UAsXnBC,YAtXmB,GAsXJ,UAAClG,GAAD,EAAM0F,KAAN,EAAgB;AAC7B1D,MAAAA,OAAO,CAACC,GAAR,CAAYjC,GAAZ;;AACA,UAAIA,GAAG,CAACT,KAAJ,KAAc,aAAlB,EAAiC;AAC/B,cAAKU,UAAL;AACD;;AACD,UAAID,GAAG,CAACT,KAAJ,KAAc,MAAlB,EAA0B;AACxB,cAAK2C,KAAL,CAAW,WAAX;AACD;;AACD,UAAIlC,GAAG,CAACT,KAAJ,KAAc,QAAlB,EAA4B;AAC1B,cAAKkG,SAAL,CAAe,cAAf;AACD;;AACD,UAAIzF,GAAG,CAACT,KAAJ,KAAc,QAAlB,EAA4B;AAC1B,cAAKqG,UAAL,CAAgBF,KAAhB;AACD;AACF,KApYkB;;AAEjB,QAAI3E,EAAJ;AACA,UAAKA,EAAL,GAAUA,EAAV;;AACA,QAAImE,OAAJ,EAAYc,SAAZ,EAAuBtG,QAAvB;;AACA,UAAKA,OAAL,GAAeA,QAAf;AACA,UAAKsG,SAAL,GAAiBA,SAAjB;;AACA3B,IAAAA,KAAK,CAACC,SAAN,CAAgBP,MAAhB,GAAyB,UAASoC,MAAT,EAAiB;AACxC,aAAO,KAAKC,MAAL,CAAY,UAASC,IAAT,EAAeC,IAAf,EAAqB;AACtC,eAAOD,IAAI,CAACF,MAAD,CAAJ,GAAeG,IAAI,CAACH,MAAD,CAAnB,GAA8BE,IAA9B,GAAqCC,IAA5C;AACD,OAFM,CAAP;AAGD,KAJD;;AAMAjC,IAAAA,KAAK,CAACC,SAAN,CAAgBL,MAAhB,GAAyB,UAASkC,MAAT,EAAiB;AACxC,aAAO,KAAKC,MAAL,CAAY,UAASC,IAAT,EAAeC,IAAf,EAAqB;AACtC,eAAOD,IAAI,CAACF,MAAD,CAAJ,GAAeG,IAAI,CAACH,MAAD,CAAnB,GAA8BE,IAA9B,GAAqCC,IAA5C;AACD,OAFM,CAAP;AAGD,KAJD;;AAbiB;AAmBpB;;;;wCASqB;AAAA;;AACf,WAAK5G,OAAL,GAAe,IAAI6G,UAAJ,CAAe;AAC9BC,QAAAA,SAAS,EAAE,GADmB;AAE9BC,QAAAA,QAAQ,EAAE,kBAACC,IAAD,EAAU;AAClBA,UAAAA,IAAI,CAAC1H,CAAC,CAAC,SAAD,CAAD,CAAagB,GAAb,EAAD,CAAJ;AACD,SAJ6B;AAK9B2G,QAAAA,QAAQ,EAAE,oBAAO;AACf;AACA,cAAI,CAAC,MAAI,CAACjH,OAAV,EAAmB;AACnBD,UAAAA,aAAa,CAAC,MAAI,CAACC,OAAN,CAAb;AACD;AAT6B,OAAf,CAAf;AAYFV,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAW4H,KAAX,CAAiB,YAAW;AAC1B,aAAKlH,OAAL,CAAamH,IAAb,CAAkB/G,iBAAlB;AACD,OAFD;AAGAd,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAW4H,KAAX,CAAiB,YAAW;AAC1B,aAAKlH,OAAL,CAAaoH,IAAb,CAAkBhH,iBAAlB;AACD,OAFD;AAGAd,MAAAA,CAAC,CAAC,SAAD,CAAD,CAAa+H,QAAb,CAAsB,YAAW;AAC/B,aAAKrH,OAAL,CAAasH,IAAb;AACD,OAFD;AAIAvH,MAAAA,aAAa,CAAC,KAAKC,OAAN,CAAb;AAED,UAAIuH,OAAO,GAAG,EAAd;AACA,UAAIC,WAAW,GAAG,EAAlB;AACA,WAAKnG,EAAL,GAAU,IAAI9B,UAAJ,CAAe;AACvBkI,QAAAA,WAAW,EAAElG,QAAQ,CAACC,sBAAT,CAAgC,YAAhC,CADU;AAEvBkG,QAAAA,IAAI,EAAEnG,QAAQ,CAACoG,cAAT,CAAwB,QAAxB,CAFiB;AAGvBC,QAAAA,eAAe,EAAE,yBAAA5E,OAAO,EAAI;AAC1BuE,UAAAA,OAAO,CAACnE,IAAR,CAAa,MAAI,CAAC/B,EAAL,CAAQwG,YAAR,EAAb;AACAvF,UAAAA,OAAO,CAACC,GAAR,CAAYgF,OAAZ;AACAC,UAAAA,WAAW,GAAGD,OAAO,CAAC5E,GAAR,CAAY,UAAAK,OAAO,EAAI;AACnC,gBACE1D,CAAC,CAAC0D,OAAD,CAAD,CACG/C,IADH,CACQ,IADR,EAEGgF,OAFH,CAEW,MAFX,IAEqB,CAAC,CAHxB,EAIE;AACA;AACD;AACF,WARa,CAAd;AASD;AAfsB,OAAf,CAAV;AAiBA3F,MAAAA,CAAC,CAAC,OAAD,CAAD,CAAW6B,SAAX,CAAqB;AACnBC,QAAAA,MAAM,EAAE;AADW,OAArB;AAIA9B,MAAAA,CAAC,CAAC,SAAD,CAAD,CAAawI,EAAb,CAAgB,WAAhB,EAA6B,iBAA7B,EAAgD,UAAA3B,CAAC,EAAI;AACnD7G,QAAAA,CAAC,CAAC,gBAAD,CAAD,CAAoBuB,GAApB,CAAwB;AACtBoF,UAAAA,OAAO,EAAE;AADa,SAAxB;AAGA3G,QAAAA,CAAC,CAAC,SAAD,CAAD,CAAauB,GAAb,CAAiB;AACfoF,UAAAA,OAAO,EAAE;AADM,SAAjB;;AAGA,YACE3G,CAAC,CAAC6G,CAAC,CAAC4B,MAAH,CAAD,CACG9H,IADH,CACQ,OADR,EAEGgF,OAFH,CAEW,gBAFX,IAE+B,CAAC,CAHlC,EAIE;AACA,cAAI3F,CAAC,CAAC,UAAD,CAAD,CAAcmB,MAAd,GAAuB,CAA3B,EAA8B;AAC5B,YAAA,MAAI,CAACsF,SAAL;AACD;;AACD,UAAA,MAAI,CAAC1E,EAAL,CAAQ2G,KAAR;AACD,SATD,MASO;AACL,UAAA,MAAI,CAAC1B,SAAL,GAAiBH,CAAC,CAAC4B,MAAnB;AACAzI,UAAAA,CAAC,CAAC,SAAD,CAAD,CAAauB,GAAb,CAAiB;AACfoF,YAAAA,OAAO,EAAE;AADM,WAAjB;AAGAsB,UAAAA,OAAO,GAAG,EAAV;;AACA,UAAA,MAAI,CAAClG,EAAL,CAAQ4G,IAAR;;AACA,UAAA,MAAI,CAAC5G,EAAL,CAAQ6G,KAAR;AACD;AACF,OAzBD;AA0BA5I,MAAAA,CAAC,CAAC,SAAD,CAAD,CAAawI,EAAb,CAAgB,SAAhB,EAA2B,UAAA3B,CAAC,EAAI;AAC9B,YAAIoB,OAAO,CAAC9G,MAAR,GAAiB,CAArB,EAAwB;AACtB,UAAA,MAAI,CAAC+B,KAAL,CAAW+E,OAAX;AACD;;AACD,QAAA,MAAI,CAAClG,EAAL,CAAQ4G,IAAR;;AACA,QAAA,MAAI,CAAC5G,EAAL,CAAQ2G,KAAR;AACD,OAND;AAOA1I,MAAAA,CAAC,CAAC,MAAD,CAAD,CAAUwI,EAAV,CAAa,UAAb,EAAyB,UAAA3B,CAAC,EAAI;AAC5B,YAAG,MAAI,CAACG,SAAR,EAAkB;AAClB,UAAA,MAAI,CAACJ,UAAL,CAAgBC,CAAhB;AAAmB;;AAAA;AACpB,OAHD;AAID;;;6BAoRQ;AAAA;;AACP,UAAIgC,MAAM,GAAG,KAAKxI,KAAL,CAAWC,GAAX,CAAe+C,GAAf,CAAmB,UAACK,OAAD,EAAUrB,CAAV,EAAgB;AAC9C,eACE,oBAAC,MAAD;AACE,UAAA,KAAK,EAAEqB,OADT;AAEE,UAAA,OAAO,EAAE,iBAAAgD,KAAK;AAAA,mBAAI,MAAI,CAACQ,YAAL,CAAkBxD,OAAlB,EAA2BgD,KAA3B,CAAJ;AAAA,WAFhB;AAGE,UAAA,GAAG,EAAErE,CAAC,GAAGqB,OAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAOD,OARY,CAAb;AASA,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGmF,MADH,EAEE;AAAK,QAAA,EAAE,EAAC,QAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAiC,QAAA,EAAE,EAAC,OAApC;AAA4C,QAAA,SAAS,EAAC,MAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAIE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAiC,QAAA,EAAE,EAAC,OAApC;AAA4C,QAAA,SAAS,EAAC,MAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAJF,CADF,CAFF,CADF;AAeD;;;;EA1ae9I,S;;AA4alB,eAAeI,GAAf","sourcesContent":["import React, { Component } from \"react\";\nimport \"./App.css\";\nimport $ from \"jquery\";\nimport \"jquery-ui/ui/widgets/draggable\";\nimport DragSelect from \"dragselect\";\nimport Button from \"./components/Button/Button\"; // --> OFF\n\n/* eslint no-undef: 0 */ \n// eslint-disable-next-line \nclass App extends Component {\n  state = {\n    btn: [\n      { value: \"Add Element\", id: \"\" },\n      { value: \"Wrap\", id: \"group\" },\n      { value: \"Unwrap\", id: \"ungroup\" },\n      { value: \"unwrapPerm\", id: \"ungroupIndivi\" },\n      { value: \"Delete\", id: \"delete\" },\n      { value: \"Undo\", id: \"undo\" },\n      { value: \"Redo\", id: \"redo\" }\n    ]\n  };\n  constructor(props) {\n    super(props);\n    var ds;\n    this.ds = ds;\n    var permID, deleteElm, history;\n    this.history = history;\n    this.deleteElm = deleteElm;\n    Array.prototype.hasMin = function(attrib) {\n      return this.reduce(function(prev, curr) {\n        return prev[attrib] < curr[attrib] ? prev : curr;\n      });\n    };\n\n    Array.prototype.hasMax = function(attrib) {\n      return this.reduce(function(prev, curr) {\n        return prev[attrib] > curr[attrib] ? prev : curr;\n      });\n    };\n    \n}\n updateButtons = (history)  => {\n\t$('#undo').attr('disabled',!history.canUndo());\n\t$('#redo').attr('disabled',!history.canRedo());\n}\n\nsetEditorContents = (contents) => {\n\t$('.main-container').val(contents);\n}\n  componentDidMount() {\n       this.history = new SimpleUndo({\n       maxLength: 200,\n       provider: (done) => {\n         done($('#canvas').val());\n       },\n       onUpdate: ()  => {\n         //onUpdate is called in constructor, making history undefined\n         if (!this.history) return; \n         updateButtons(this.history);\n       }\n     });\n     \n     $('#undo').click(function() {\n       this.history.undo(setEditorContents);\n     });\n     $('#redo').click(function() {\n       this.history.redo(setEditorContents);\n     });\n     $('#editor').keypress(function() {\n       this.history.save();\n     });\n     \n     updateButtons(this.history);\n \n    var idArray = [];\n    var permIdarray = [];\n    this.ds = new DragSelect({\n      selectables: document.getElementsByClassName(\"ele-select\"),\n      area: document.getElementById(\"canvas\"),\n      onElementSelect: element => {\n        idArray.push(this.ds.getSelection());\n        console.log(idArray);\n        permIdarray = idArray.map(element => {\n          if (\n            $(element)\n              .attr(\"id\")\n              .indexOf(\"perm\") > -1\n          ) {\n            return;\n          }\n        });\n      }\n    });\n    $(\".text\").draggable({\n      cursor: \"move\"\n    });\n\n    $(\"#canvas\").on(\"mousedown\", \".main-container\", e => {\n      $(\"#ungroupIndivi\").css({\n        opacity: 0\n      });\n      $(\"#delete\").css({\n        opacity: 0\n      });\n      if (\n        $(e.target)\n          .attr(\"class\")\n          .indexOf(\"main-container\") > -1\n      ) {\n        if ($(\".wrapped\").length > 0) {\n          this.unwrapAll();\n        }\n        this.ds.start();\n      } else {\n        this.deleteElm = e.target;\n        $(\"#delete\").css({\n          opacity: 1\n        });\n        idArray = [];\n        this.ds.stop();\n        this.ds.break();\n      }\n    });\n    $(\"#canvas\").on(\"mouseup\", e => {\n      if (idArray.length > 1) {\n        this.check(idArray);\n      }\n      this.ds.stop();\n      this.ds.start();\n    });\n    $(\"body\").on(\"keypress\", e => {\n      if(this.deleteElm){\n      this.deleteElme(e)};\n    });\n  }\n\n  addElement = () => {\n    if ($(\".main-container\").children().length) {\n      var x = $(\".text:last\");\n      var top = parseFloat(x.css(\"top\").slice(0, -2));\n      x = x.attr(\"id\").slice(-1);\n      $(\".main-container\").append(\n        \"<div class='text ele-select'>\" + Math.random().toFixed(2) + \"</div>\"\n      );\n      $(\".text:last\").attr(\"id\", \"text\" + ++x);\n      $(\".text:last\").css({\n        top: top + 27\n      });\n      $(\".text:last\").draggable({\n        cursor: \"move\"\n      });\n      this.ds.addSelectables(document.getElementsByClassName(\"ele-select\"));\n    } else {\n      $(\".main-container\").append(\n        \"<div class='text ele-select'>\" + Math.random().toFixed(2) + \"</div>\"\n      );\n      $(\".text\").attr(\"id\", \"text\" + 1);\n      $(\".text:last\").draggable({\n        cursor: \"move\"\n      });\n      this.ds.addSelectables(document.getElementsByClassName(\"ele-select\"));\n    }\n  };\n\n  setElemPosition = (el, i, wrappedPostion) => {\n    return new Promise((resolve, reject) => {\n      var indivElePos = {};\n      indivElePos.top = el.top;\n      indivElePos.left = el.left;\n      indivElePos.diffTop =\n        indivElePos.top < wrappedPostion.wrappedTop.top\n          ? wrappedPostion.wrappedTop.top - indivElePos.top\n          : indivElePos.top - wrappedPostion.wrappedTop.top;\n      indivElePos.diffLeft =\n        indivElePos.left < wrappedPostion.wrappedLeft.left\n          ? wrappedPostion.wrappedLeft.left - indivElePos.left\n          : indivElePos.left - wrappedPostion.wrappedLeft.left;\n      $(\"#\" + el.id).css({\n        top: indivElePos.diffTop,\n        left: indivElePos.diffLeft\n      });\n      console.log(\"indivElePos\", indivElePos);\n      resolve(indivElePos);\n    });\n  };\n\n  check = idArr => {\n    if (idArr[0].length > 1 && idArr !== \"permGroup\") {\n      var valTemp = idArr[0].map(value => {\n        return \"#\" + $(value).attr(\"id\");\n      });\n      var valString = valTemp.toString();\n      $(valString).wrapAll('<div class=\"wrapped ele-select\"></div>');\n      valTemp.forEach(element => {\n        $(element).draggable(\"disable\");\n      });\n      $(\".wrapped\").draggable({\n        cursor: \"move\"\n      });\n      var ch = $(\".wrapped\").children();\n      let childArray = [];\n      ch.each((i, el) => {\n        childArray.push(el);\n      });\n      var wrappedPostion = {\n        totalHeight: 0,\n        totalWidth: 0,\n        totalDiffLeft: 0,\n        totalDiffTop: 0\n      };\n      var postionArray = childArray.map(element => {\n        var obj = {};\n        obj.id = $(element).attr(\"id\");\n        obj.top = parseFloat(\n          $(element)\n            .css(\"top\")\n            .slice(0, -2)\n        );\n        obj.left = parseFloat(\n          $(element)\n            .css(\"left\")\n            .slice(0, -2)\n        );\n        obj.height = $(element).outerHeight();\n        obj.width = $(element).outerWidth();\n        obj.right = obj.left + obj.width;\n        obj.bottom = obj.top + obj.height;\n        if (wrappedPostion.totalWidth < $(element).outerWidth()) {\n          wrappedPostion.totalWidth = $(element).outerWidth();\n        }\n        return obj;\n      });\n      var wrappedDetails = {};\n      postionArray.sort((a, b) => (b.top < a.top ? 1 : -1));\n      console.log(\"postionArray after sorting\", postionArray);\n      wrappedPostion.wrappedTop = postionArray.hasMin(\"top\");\n      wrappedPostion.wrappedLeft = postionArray.hasMin(\"left\");\n      wrappedPostion.wrappedRight = postionArray.hasMax(\"right\");\n      wrappedPostion.wrappedBottom = postionArray.hasMax(\"bottom\");\n      console.log(wrappedPostion);\n      $(\".wrapped\").css({\n        top: wrappedPostion.wrappedTop.top,\n        left: wrappedPostion.wrappedLeft.left,\n        width:\n          wrappedPostion.wrappedRight.right - wrappedPostion.wrappedLeft.left,\n        height:\n          wrappedPostion.wrappedBottom.bottom - wrappedPostion.wrappedTop.top\n      });\n      postionArray.map(async (el, i) => {\n        await this.setElemPosition(el, i, wrappedPostion).then(val => {\n          postionArray[i].diffTop = val.diffTop;\n          postionArray[i].diffLeft = val.diffLeft;\n          if (wrappedPostion.totalDiffLeft < val.diffLeft) {\n            wrappedPostion.totalDiffLeft = val.diffLeft;\n          }\n          console.log(\"setElemPosition postionArray\", postionArray);\n          console.log(\"setElemPosition wrappedPostion\", wrappedPostion);\n        });\n      });\n    } else {\n      // console.log(idArr)\n      if (idArr === \"permGroup\") {\n        var count = 0;\n        Array.prototype.slice\n          .call(document.querySelectorAll(\".wrapped\"))\n          .forEach(wrapped => {\n            Array.prototype.slice\n              .call($(\".wrapped\").children())\n              .forEach(wrappedChild => {\n                if (\n                  $(wrappedChild)\n                    .attr(\"id\")\n                    .indexOf(\"perm\") > -1\n                ) {\n                  count++;\n                }\n              });\n          });\n        if (count === 0) {\n          $(\".wrapped\").toggleClass(\"wrapped perm-wrapped\");\n          var cnt = $(\".perm-wrapped\");\n          cnt.each((i, el) => {\n            $(el).attr(\"id\", \"perm-select\" + i);\n          });\n          cnt.children().each((i, el) => {\n            $(el).removeClass(\"ele-select\");\n          });\n          Array.prototype.slice\n            .call(document.querySelectorAll(\".perm-wrapped\"))\n            .forEach(wrapped => {\n              this.ds.addSelectables(wrapped);\n              this.ds.removeSelectables(wrapped.children, true);\n            });\n        } else {\n          alert(\"Kindly ungroup and then group\");\n        }\n      }\n    }\n  };\n  /* To unnwrap permanent */\n  unwrapPer = () => {\n    console.log(permID);\n    var val = $(permID).attr(\"id\");\n    permID = \"\";\n    var cnt = $(\"#\" + val);\n\n    cnt.children().each((i, el) => {\n      var parent = $(el)\n        .parent()\n        .position();\n      var pTop = parent.top;\n      var pLeft = parent.left;\n      console.log($(el).parent(), parent);\n      console.log(pTop, pLeft);\n      $(el).css({\n        top:\n          parseFloat(\n            $(el)\n              .css(\"top\")\n              .slice(0, -2)\n          ) + pTop,\n        left:\n          parseFloat(\n            $(el)\n              .css(\"left\")\n              .slice(0, -2)\n          ) + pLeft\n      });\n      $(el).draggable(\"enable\");\n      $(el).addClass(\"ele-select\");\n      this.ds.addSelectables(el);\n    });\n    cnt.children().unwrap();\n  };\n\n  /* working unWrapAll */\n  unwrapAll = (val, event) => {\n    let wrappedTop, wrappedLeft;\n    if (val === \"perm-ungroup\") {\n      var cnt = $(\".perm-wrapped\");\n      $(\"#ungroupIndivi\").css({\n        opacity: 1\n      });\n    } else {\n      var cnt = $(\".wrapped\");\n      wrappedTop = parseFloat(\n        $(\".wrapped\")\n          .css(\"top\")\n          .slice(0, -2)\n      );\n      wrappedLeft = parseFloat(\n        $(\".wrapped\")\n          .css(\"left\")\n          .slice(0, -2)\n      );\n      // console.log(wrappedTop, wrappedLeft)\n    }\n\n    cnt.children().each((i, el) => {\n      var parent = $(el)\n        .parent()\n        .position();\n      var pTop = parent.top;\n      var pLeft = parent.left;\n      $(el).css({\n        top:\n          parseFloat(\n            $(el)\n              .css(\"top\")\n              .slice(0, -2)\n          ) + pTop,\n        left:\n          parseFloat(\n            $(el)\n              .css(\"left\")\n              .slice(0, -2)\n          ) + pLeft\n      });\n      $(el).draggable(\"enable\");\n      $(el).addClass(\"ele-select\");\n      this.ds.addSelectables(el);\n    });\n    cnt.children().unwrap();\n  };\n  deleteElme = e => {\n    console.log(e)\n    if (e.keyCode === 127 || e.type === 'click') {\n      if ($(this.deleteElm).parent().attr('class') !== 'main-container') {\n          $(this.deleteElm).parent().remove();\n      }\n      else {\n          $(this.deleteElm).remove();\n      }\n  }\n  };\n  clickHandler = (val, event) => {\n    console.log(val);\n    if (val.value === \"Add Element\") {\n      this.addElement();\n    }\n    if (val.value === \"Wrap\") {\n      this.check(\"permGroup\");\n    }\n    if (val.value === \"Unwrap\") {\n      this.unwrapAll(\"perm-ungroup\");\n    }\n    if (val.value === \"Delete\") {\n      this.deleteElme(event);\n    }\n  };\n  render() {\n    var button = this.state.btn.map((element, i) => {\n      return (\n        <Button\n          value={element}\n          clicked={event => this.clickHandler(element, event)}\n          key={i + element}\n        />\n      );\n    });\n    return (\n      <div>\n        {button}\n        <div id=\"canvas\">\n          <div className=\"main-container\">\n            <div className=\"text ele-select\" id=\"text1\" draggable=\"true\">\n              Some text\n            </div>\n            <div className=\"text ele-select\" id=\"text2\" draggable=\"true\">\n              Another text\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}